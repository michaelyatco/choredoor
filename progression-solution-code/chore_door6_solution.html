<!DOCTYPE html>
  <head>
    <title>Chore Door!</title>
    <link href='./chore_door6_style.css' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Work+Sans" rel="stylesheet" type='text/css'>
  </head>

  <body>

    <div class="header">
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/logo.svg">
    </div>

    <div class="first-row">
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/star.svg">
      <p class="instructions-title">Instructions</p>
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/star.svg">
    </div>

    <div class="second-row">
      <div class="each-direction">
        <p class="instructions">1. Hiding behind one of these doors is the ChoreBot.</p>
      </div>
      <div class="each-direction">
        <p class="instructions">2. Your mission is to open all of the doors without running into the ChoreBot.</p>
      </div>
      <div class="each-direction">
        <p class="instructions">3. If you manage to avoid the ChoreBot until the very last door, you win!</p>
      </div>
      <div class="each-direction">
        <p class="instructions">4. See if you can score a winning streak!</p>
      </div>
    </div>

    <div class="door-row">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door1">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door2">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door3">
    </div>

    <div class="start-row" id="start">Good luck!</div>

  </body>
  <script>
    let door1 = document.getElementById('door1');
    let door2 = document.getElementById('door2');
    let door3 = document.getElementById('door3');
    let startButton = document.getElementById('start');
    let botDoorPath = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/robot.svg";
    let beachDoorPath = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/beach.svg";
    let spaceDoorPath = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/space.svg";
    let closedDoorPath = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg"
    let numClosedDoors = 3;
    let openDoor1;
    let openDoor2;
    let openDoor3;
    let currentlyPlaying = true;

    const isClicked = (door) => {
      if (door.src == closedDoorPath) {
        return false;
      } else {
        return true;
      }
    }

    const isBot = (door) => {
      if (door.src === botDoorPath) {
        return true;
      } else {
        return false;
      }
    }

    const playDoor = (door) => {
      numClosedDoors--;
      if (numClosedDoors === 0) {
        gameOver('win');
      } else if (isBot(door)) {
        gameOver('lose');
      }
    }

    const randomChoreDoorGenerator = () => {
      choreDoor = Math.floor(Math.random() * numClosedDoors);
      if (choreDoor === 0) {
        openDoor1 = botDoorPath;
        openDoor2 = beachDoorPath;
        openDoor3 = spaceDoorPath;
      } else if (choreDoor === 1) {
        openDoor2 = botDoorPath;
        openDoor1 = beachDoorPath;
        openDoor3 = spaceDoorPath;
      } else {
        openDoor3 = botDoorPath;
        openDoor1 = beachDoorPath;
        openDoor2 = spaceDoorPath;
      }
    }

    door1.onclick = () => {
      if(currentlyPlaying && !isClicked(door1)) {
        door1.src = openDoor1;
        playDoor(door1);
      }
    }

    door2.onclick = () => {
      if(currentlyPlaying && !isClicked(door2)) {
        door2.src = openDoor2;
        playDoor(door2);
      }
    }

    door3.onclick = () => {
      if(currentlyPlaying && !isClicked(door3)) {
        door3.src = openDoor3;
        playDoor(door3);
      }
    }

    startButton.onclick = () => {
        startRound();
    }

    const startRound = () => {
      // Reset all the doors to be closed
      door1.src = closedDoorPath;
      door2.src = closedDoorPath;
      door3.src = closedDoorPath;
      numClosedDoors = 3;
      currentlyPlaying = true;
      startButton.innerHTML = 'Good luck!';
      randomChoreDoorGenerator();
    }

    const gameOver = (str) => {
      if(str === 'win') {
        startButton.innerHTML = 'You win! Play again?';
      } else {
        startButton.innerHTML = "Game over! Play again?"
      }
      currentlyPlaying = false;
    }

    startRound();

  </script>
</html>
