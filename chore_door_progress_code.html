<!DOCTYPE html>

  <head>
    <title>Chore Door!</title>
    <link href='./progressing_style.css' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Work+Sans" rel="stylesheet" type='text/css'>
  </head>

  <body>

    <div class="header">
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/logo.svg">
    </div>

    <div class="first-row">
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/star.svg">
      <p class="instructions-title">Instructions</p>
      <img src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/star.svg">
    </div>

    <table class="second-row">
      <tr>
        <td class="instructions-number">1</td>
        <td class="instructions-text">Hiding behind one of these doors is the ChoreBot.</td>
      </tr>
      <tr>
        <td class="instructions-number">2</td>
        <td class="instructions-text">Your mission is to open all of the doors without running into the ChoreBot.</td>
      </tr>
      <tr>
        <td class="instructions-number">3</td>
        <td class="instructions-text">If you manage to avoid the ChoreBot until the very last door, you win!</td>
      </tr>
      <tr>
        <td class="instructions-number">4</td>
        <td class="instructions-text">See if you can score a winning streak!</td>
      </tr>
    </table>

    <div class="door-row">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door1">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door2">
      <img class="door-frame" src="https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg" id="door3">
    </div>

    <div class="start-row" id="start">Good luck!</div>

    <div class="score-row">
      <p class="score-text">Current streak:</p>
      <p class="score-text">Best streak:</p>
    </div>

    <div class="score-row">
      <div class="score-box" id="score-number"></div>
      <div class="score-box" id="high-score-number"></div>
    </div>

  </body>

  <script>
    let doorImage1 = document.getElementById('door1');
    let doorImage2 = document.getElementById('door2');
    let doorImage3 = document.getElementById('door3');
    let startButton = document.getElementById("start");
    let botDoor = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/robot.svg";
    let beachDoor = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/beach.svg";
    let spaceDoor = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/space.svg";
    let closedDoor = "https://s3.amazonaws.com/codecademy-content/projects/chore-door/images/closed_door.svg";
    let doors = 3;
    let openDoor1;
    let openDoor2;
    let openDoor3;
    let door1Doom;
    let door2Doom;
    let door3Doom;
    let door1Clicked = false;
    let door2Clicked = false;
    let door3Clicked = false;
    let currentlyPlaying = false;
    let score = 0;
    let highScore = 0;
    let scoreDisplay = document.getElementById('score-number');
    let highScoreDisplay = document.getElementById('high-score-number');
    scoreDisplay.innerHTML = score;
    highScoreDisplay.innerHTML = highScore;

    startButton.onclick = () => {
      if (!currentlyPlaying) {
        startRound();
      }
    }

    const startRound = () => {
      currentlyPlaying = true;
      door1Clicked = false;
      door2Clicked = false;
      door3Clicked = false;
      door1Doom = false;
      door2Doom = false;
      door3Doom = false;
      doors = 3;
      doorImage1.src = closedDoor;
      doorImage2.src = closedDoor;
      doorImage3.src = closedDoor;
      startButton.innerHTML = 'Good luck!';
      randomChoreDoorGenerator();
    }

    const randomChoreDoorGenerator = () => {
      choreDoor = Math.floor(Math.random() * doors);
      if (choreDoor === 0) {
        door1Doom = true;
        openDoor1 = botDoor;
        openDoor2 = beachDoor;
        openDoor3 = spaceDoor;
      } else if (choreDoor === 1) {
        door2Doom = true;
        openDoor2 = botDoor;
        openDoor1 = beachDoor;
        openDoor3 = spaceDoor;
      } else {
        door3Doom = true;
        openDoor3 = botDoor;
        openDoor1 = beachDoor;
        openDoor2 = spaceDoor;
      }
    }

    doorImage1.onclick = () => {
      if (!door1Clicked) {
        door1Clicked = true;
        doorImage1.src = openDoor1;
        doors--;
        if (doors===0) {
          winnerGameOver();
        } else if (door1Doom) {
          gameOver();
        }
      }
    }

    doorImage2.onclick = () => {
      if (!door2Clicked) {
        door2Clicked = true;
        doorImage2.src = openDoor2;
        doors--;
        if (doors===0) {
          winnerGameOver();
        } else if (door2Doom) {
          gameOver();
        }
      }
    }

    doorImage3.onclick = () => {
      if (!door3Clicked) {
        door3Clicked = true;
        doorImage3.src = openDoor3;
        doors--;
        if (doors===0) {
          winnerGameOver();
        } else if (door3Doom) {
          gameOver();
        }
      }
    }

    const gameOver = () => {
      score = 0;
      scoreDisplay.innerHTML = score;
      startButton.innerHTML = 'Game Over! Play again?';
      door1Clicked = true;
      door2Clicked = true;
      door3Clicked = true;
      currentlyPlaying = false;
    }

    const winnerGameOver = () => {
      score++;
      scoreDisplay.innerHTML = score;
      startButton.innerHTML = 'You win! Play again?';
      currentlyPlaying = false;
      determineHighScore();
    }

    const determineHighScore = () => {
      if (score > highScore) {
        highScore = score;
        highScoreDisplay.innerHTML = highScore;
      }
    }

    startRound();

  </script>

</html>
